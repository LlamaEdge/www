"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8264],{2906:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>d});var a=t(4848),i=t(8453);const s={sidebar_position:6},o="Translation Agent",r={id:"user-guide/openai-api/translation-agent",title:"Translation Agent",description:"This LLM Translation Agent originally built by Prof. Andrew Ng is designed to facilitate accurate and efficient translation across multiple languages. It employs open source LLMs (Large Language Models) to provide high-quality translations. You can use your own fine-tuned models or any LLMs on Hugging Face like Meta's Llama 3. This documentation shows how the Transgenic Agent utilizes the Gemma-2-9B model for translation.",source:"@site/docs/user-guide/openai-api/translation-agent.md",sourceDirName:"user-guide/openai-api",slug:"/user-guide/openai-api/translation-agent",permalink:"/docs/user-guide/openai-api/translation-agent",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/user-guide/openai-api/translation-agent.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"FlowiseAI tool call",permalink:"/docs/user-guide/openai-api/flowiseai-tool-call"},next:{title:"LangChain",permalink:"/docs/user-guide/openai-api/langchain"}},l={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Clone the Translation Agent",id:"clone-the-translation-agent",level:2},{value:"Configurations",id:"configurations",level:2},{value:"Run the Translation Agent on top of Gemma-2-9B",id:"run-the-translation-agent-on-top-of-gemma-2-9b",level:2}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"translation-agent",children:"Translation Agent"}),"\n",(0,a.jsxs)(n.p,{children:["This LLM Translation Agent originally built by ",(0,a.jsx)(n.a,{href:"https://www.linkedin.com/posts/andrewyng_github-andrewyngtranslation-agent-activity-7206347897938866176-5tDJ/",children:"Prof. Andrew Ng"})," is designed to facilitate accurate and efficient translation across multiple languages. It employs open source LLMs (Large Language Models) to provide high-quality translations. You can use your own fine-tuned models or any LLMs on Hugging Face like Meta's Llama 3. This documentation shows how the Transgenic Agent utilizes the Gemma-2-9B model for translation."]}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["For commands on starting and running this agent, refer to ",(0,a.jsx)(n.a,{href:"https://github.com/second-state/translation-agent/blob/use_llamaedge/step-by-step-use-LocalAI.md",children:"GitHub - Second State/translation-agent"}),"."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,a.jsxs)(n.p,{children:["Follow ",(0,a.jsx)(n.a,{href:"/docs/user-guide/openai-api/intro",children:"this guide"})," to run an open-source LLM locally.\nIn this example, we need an open source LLM that is good at multiple languages.\nThe Gemma-2 7B model from Google is a good choice here."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"curl -LO https://huggingface.co/second-state/gemma-2-9b-it-GGUF/resolve/main/gemma-2-9b-it-Q5_K_M.gguf\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Then start the LlamaEdge API server with the Gemma-2-9b model and name it ",(0,a.jsx)(n.code,{children:"gemma-2-9b-it-Q5_K_M"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"wasmedge --dir .:. \\\n    --nn-preload default:GGML:AUTO:gemma-2-9b-it-Q5_K_M.gguf \\\n    --nn-preload embedding:GGML:AUTO:nomic-embed-text-v1.5.f16.gguf \\\n    llama-api-server.wasm \\\n    --model-alias default,embedding \\\n    --model-name gemma-2-9b-it-Q5_K_M,nomic-embed-text-v1.5.f16 \\\n    --prompt-template gemma-instruct,embedding \\\n    --batch-size 128,8192 \\\n    --ctx-size 8192,8192\n"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["See detailed instructions to ",(0,a.jsx)(n.a,{href:"https://www.secondstate.io/articles/gemma-2-9b/",children:"Run Gemma-2-9B on your own device."})]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"clone-the-translation-agent",children:"Clone the Translation Agent"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"git clone https://github.com/second-state/translation-agent.git\n    \ncd translation-agent\ngit checkout use_llamaedge\n"})}),"\n",(0,a.jsx)(n.h2,{id:"configurations",children:"Configurations"}),"\n",(0,a.jsx)(n.p,{children:"You will also need the following configurations and prerequisites to run the agent app."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'export OPENAI_BASE_URL="http://localhost:8080/v1"\nexport PYTHONPATH=${PWD}/src\nexport OPENAI_API_KEY="LLAMAEDGE"\n\npip install python-dotenv\npip install openai tiktoken icecream langchain_text_splitters\n'})}),"\n",(0,a.jsx)(n.h2,{id:"run-the-translation-agent-on-top-of-gemma-2-9b",children:"Run the Translation Agent on top of Gemma-2-9B"}),"\n",(0,a.jsxs)(n.p,{children:["Here we test a simple English to Spanish translation task to see the results so as to compare their translation capabilities. You will need to install ",(0,a.jsx)(n.a,{href:"https://github.com/WasmEdge/WasmEdge",children:"WasmEdge"})," and the ",(0,a.jsx)(n.a,{href:"https://github.com/LlamaEdge/LlamaEdge",children:"LlamaEdge API server"})," to run those models across major GPU and CPU platforms."]}),"\n",(0,a.jsxs)(n.p,{children:["Find the ",(0,a.jsx)(n.code,{children:"examples/example_script.py"})," file in your cloned translation agent repo and review its code. It tells the agent where to find your document and how to translate it. Change the model name to the one you are using, here we\u2019re using ",(0,a.jsx)(n.code,{children:"gemma-2-9b"})," model; also change the source and target languages you want (here we put ",(0,a.jsx)(n.code,{children:"English"})," as the source language and ",(0,a.jsx)(n.code,{children:"Spanish"})," as the target language)."]}),"\n",(0,a.jsxs)(n.p,{children:["Find a ",(0,a.jsx)(n.code,{children:"examples/sample-texts"})," folder in your cloned repo. Put ",(0,a.jsx)(n.a,{href:"https://hackmd.io/TXpN2sI4Tt6_Y33G65V0LQ?view#Source-Text",children:"the file you want to translate"})," in this folder and get its path. Here because we named our ",(0,a.jsx)(n.a,{href:"https://hackmd.io/TXpN2sI4Tt6_Y33G65V0LQ?view#Source-Text",children:"source text"})," file ",(0,a.jsx)(n.code,{children:"docker.txt"}),", the relative path to the document would be ",(0,a.jsx)(n.code,{children:"sample-texts/docker.txt"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'import os\n\nimport translation_agent as ta\n\n\nif __name__ == "__main__":\n    source_lang, target_lang, country = "English", "Spanish", "Spain"\n\n    relative_path = "sample-texts/docker.txt"\n    script_dir = os.path.dirname(os.path.abspath(__file__))\n\n    full_path = os.path.join(script_dir, relative_path)\n\n    with open(full_path, encoding="utf-8") as file:\n        source_text = file.read()\n\n    print(f"Source text:\\n\\n{source_text}\\n------------\\n")\n\n    translation = ta.translate(\n        source_lang=source_lang,\n        target_lang=target_lang,\n        source_text=source_text,\n        country=country,\n        model="gemma-2-9b",\n    )\n\n    print(f"Translation:\\n\\n{translation}")\n'})}),"\n",(0,a.jsx)(n.p,{children:"Run the below commands to have your text file translated into English."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"cd examples    \npython example_script.py\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Wait a few minutes and ",(0,a.jsx)(n.a,{href:"https://hackmd.io/tdLiVR3TSc-8eVg_E-j9QA?view#English-Translation-by-Gemma-2-9B",children:"the Spanish translation"})," will appear on your terminal screen."]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:t(8346).A+"",width:"1784",height:"1442"})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8346:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/translation-agent-33c2477fc388a206b2c32c899d27d95e.png"},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>r});var a=t(6540);const i={},s=a.createContext(i);function o(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);